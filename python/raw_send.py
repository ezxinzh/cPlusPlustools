import socket
import struct

src_addr = "\x01\x01\x01\x01\x01\x01"
dst_addr = "\x02\x02\x02\x02\x02\x02"
ethertype = "\x08\x01"

i = 0
while (i < 500):
        if i == 0:
                send_data = "\xff"
        else:
                send_data = send_data + "\xaa"
        i = i + 1

client = socket.socket(socket.AF_PACKET, socket.SOCK_RAW)
client.bind(("br0", 0))

# icmp
#strr = "\x52\x54\x00\x33\x08\x42\xfe\x54\x00\x90\x2f\x99\x08\x00\x45\x00\x00\x54\xf1\x74\x40\x00\x00\x01\x83\x2f\x01\x01\x01\x02\x02\x02\x02\x01\x08\x00\x72\xa3\x3f\xdd\x00\x01\xac\x27\x3e\x5f\x00\x00\x00\x00\x9b\x24\x01\x00\x00\x00\x00\x00\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37"

# arp hardware type: Ethernet (2)
#strr="\xff\xff\xff\xff\xff\xff\x00\x0c\x29\xdd\x4f\xcc\x08\x06\x00\x01\x08\x01\x06\x04\x00\x01\x00\x0c\x29\xdd\x4f\xcc\xc0\xa8\xba\x42\x00\x00\x00\x00\x00\x00\xc0\xa8\xba\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

# arp Protocol type: IPv4 (0x0801)
strr="\xff\xff\xff\xff\xff\xff\x00\x0c\x29\xdd\x4f\xcc\x08\x06\x00\x01\x08\x01\x06\x04\x00\x01\x00\x0c\x29\xdd\x4f\xcc\xc0\xa8\xba\x42\x00\x00\x00\x00\x00\x00\xc0\xa8\xba\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

# arp OpCode 0x0005
# strr="\xff\xff\xff\xff\xff\xff\x00\x0c\x29\xdd\x4f\xcc\x08\x06\x00\x01\x08\x01\x06\x04\x00\x01\x00\x0c\x29\xdd\x4f\xcc\xc0\xa8\xba\x42\x00\x00\x00\x00\x00\x00\xc0\xa8\xba\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"

# ip option source route
#str="04f8f8b13c1900109400000208004600006ef92c0000fffd595d6f0101026f01010183030400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d3f731d909e3c71300bd7ec5e5dd5c8173aef3a7"

#str="525400330843fe5400902f990800460000544f7440004001e73001010102010101010800bc456d0b0001f382405f00000000d6f8050000000000101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f3031323334353637"

"""
功能说明：可以伪造一些指定特征的ARP请求或应答报文
使用说明：python raw_send.py或者python3 raw_send.py
"""
#14+payload
#client.send(dst_addr+src_addr+ethertype+send_data)
client.send(strr)